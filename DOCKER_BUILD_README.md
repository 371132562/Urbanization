# Docker æ„å»ºé…ç½®è¯´æ˜

æœ¬é¡¹ç›®æ”¯æŒå¤šä¸ªå‰ç«¯é¡¹ç›®çš„ç‹¬ç«‹æ„å»ºå’Œéƒ¨ç½²ï¼Œæ¯ä¸ªå‰ç«¯é¡¹ç›®éƒ½æœ‰å¯¹åº”çš„Dockerfileå’ŒGitHubå·¥ä½œæµã€‚

## ğŸ“ æ–‡ä»¶ç»“æ„

### Dockerfile æ–‡ä»¶
- `Dockerfile` - åŸå§‹é…ç½®ï¼Œç”¨äºfrontendé¡¹ç›®ï¼ˆå‘åå…¼å®¹ï¼‰
- `Dockerfile.data` - ç”¨äºfrontend-dataé¡¹ç›®
- `Dockerfile.score` - ç”¨äºfrontend-scoreé¡¹ç›®  
- `Dockerfile.evaluation` - ç”¨äºfrontend-evaluationé¡¹ç›®

### Docker Compose æ–‡ä»¶
- `docker-compose.yml` - åŸå§‹é…ç½®ï¼ˆå‘åå…¼å®¹ï¼‰
- `docker-compose.data.yml` - æ•°æ®ç®¡ç†å®¢æˆ·ç«¯é…ç½®ï¼ˆç«¯å£3333ï¼‰
- `docker-compose.score.yml` - è¯„åˆ†ç®¡ç†å®¢æˆ·ç«¯é…ç½®ï¼ˆç«¯å£3334ï¼‰
- `docker-compose.evaluation.yml` - è¯„ä¼°ç®¡ç†å®¢æˆ·ç«¯é…ç½®ï¼ˆç«¯å£3335ï¼‰

### GitHub å·¥ä½œæµæ–‡ä»¶
- `.github/workflows/create-release.yml` - åŸå§‹å·¥ä½œæµï¼ˆå‘åå…¼å®¹ï¼‰
- `.github/workflows/create-release-data.yml` - æ•°æ®ç®¡ç†å®¢æˆ·ç«¯å‘å¸ƒ
- `.github/workflows/create-release-score.yml` - è¯„åˆ†ç®¡ç†å®¢æˆ·ç«¯å‘å¸ƒ
- `.github/workflows/create-release-evaluation.yml` - è¯„ä¼°ç®¡ç†å®¢æˆ·ç«¯å‘å¸ƒ

## ğŸ”§ æ„å»ºé…ç½®ç‰¹ç‚¹

### 1. ç‹¬ç«‹çš„é•œåƒåç§°
æ¯ä¸ªé¡¹ç›®ä½¿ç”¨ç‹¬ç«‹çš„é•œåƒåç§°ï¼Œç¡®ä¿ï¼š
- `linstar666/urbanization-data:latest` - æ•°æ®ç®¡ç†å®¢æˆ·ç«¯
- `linstar666/urbanization-score:latest` - è¯„åˆ†ç®¡ç†å®¢æˆ·ç«¯
- `linstar666/urbanization-evaluation:latest` - è¯„ä¼°ç®¡ç†å®¢æˆ·ç«¯
- è„šæœ¬ä¸­çš„ `urbanization.tar` æ–‡ä»¶åå¯ä»¥å¤ç”¨
- å¯åŠ¨ã€å¤‡ä»½ã€æ¢å¤è„šæœ¬æ— éœ€ä¿®æ”¹
- ç”¨æˆ·ä¸‹è½½çš„åŒ…æ–‡ä»¶åä¿æŒä¸€è‡´

### 2. å‰ç«¯ç›®å½•ç»Ÿä¸€
æ‰€æœ‰Dockerfileéƒ½å°†å‰ç«¯æ„å»ºäº§ç‰©å¤åˆ¶åˆ° `./frontend/dist` ç›®å½•ï¼Œç¡®ä¿ï¼š
- åç«¯NestJSçš„ServeStaticModuleé…ç½®æ— éœ€ä¿®æ”¹
- é™æ€æ–‡ä»¶æœåŠ¡è·¯å¾„ä¿æŒä¸€è‡´

### 3. è§¦å‘æ¡ä»¶ä¼˜åŒ–
æ¯ä¸ªå·¥ä½œæµéƒ½æœ‰ç‰¹å®šçš„è·¯å¾„è§¦å‘æ¡ä»¶ï¼š
- `frontend-data/**` - æ•°æ®ç®¡ç†é¡¹ç›®å˜æ›´
- `frontend-score/**` - è¯„åˆ†ç®¡ç†é¡¹ç›®å˜æ›´
- `frontend-evaluation/**` - è¯„ä¼°ç®¡ç†é¡¹ç›®å˜æ›´
- `backend/**` - åç«¯å˜æ›´ï¼ˆæ‰€æœ‰é¡¹ç›®éƒ½ä¼šè§¦å‘ï¼‰

### 4. ç«¯å£å’Œå·éš”ç¦»
æ¯ä¸ªé¡¹ç›®ä½¿ç”¨ç‹¬ç«‹çš„ç«¯å£å’Œæ•°æ®å·ï¼š
- æ•°æ®ç®¡ç†ï¼šç«¯å£3336ï¼Œå·db_data
- è¯„åˆ†ç®¡ç†ï¼šç«¯å£3334ï¼Œå·db_score
- è¯„ä¼°ç®¡ç†ï¼šç«¯å£3335ï¼Œå·db_evaluation

## ğŸš€ ä½¿ç”¨æ–¹æ³•

### æœ¬åœ°æ„å»º
```bash
# æ„å»ºæ•°æ®ç®¡ç†ç‰ˆæœ¬
docker build -f Dockerfile.data -t urbanization:data .

# æ„å»ºè¯„åˆ†ç®¡ç†ç‰ˆæœ¬
docker build -f Dockerfile.score -t urbanization:score .

# æ„å»ºè¯„ä¼°ç®¡ç†ç‰ˆæœ¬
docker build -f Dockerfile.evaluation -t urbanization:evaluation .
```

### æœ¬åœ°è¿è¡Œ
```bash
# è¿è¡Œæ•°æ®ç®¡ç†ç‰ˆæœ¬ï¼ˆç«¯å£3333ï¼‰
docker-compose -f docker-compose.data.yml up -d

# è¿è¡Œè¯„åˆ†ç®¡ç†ç‰ˆæœ¬ï¼ˆç«¯å£3334ï¼‰
docker-compose -f docker-compose.score.yml up -d

# è¿è¡Œè¯„ä¼°ç®¡ç†ç‰ˆæœ¬ï¼ˆç«¯å£3335ï¼‰
docker-compose -f docker-compose.evaluation.yml up -d
```

### è‡ªåŠ¨æ„å»º
å½“ä»£ç æ¨é€åˆ°masteråˆ†æ”¯æ—¶ï¼ŒGitHub Actionsä¼šæ ¹æ®å˜æ›´çš„æ–‡ä»¶è·¯å¾„è‡ªåŠ¨é€‰æ‹©å¯¹åº”çš„Dockerfileè¿›è¡Œæ„å»ºï¼š

1. **ä¿®æ”¹frontend-dataç›®å½•** â†’ è§¦å‘æ•°æ®ç®¡ç†å®¢æˆ·ç«¯æ„å»ºï¼ˆç«¯å£3333ï¼‰
2. **ä¿®æ”¹frontend-scoreç›®å½•** â†’ è§¦å‘è¯„åˆ†ç®¡ç†å®¢æˆ·ç«¯æ„å»ºï¼ˆç«¯å£3334ï¼‰
3. **ä¿®æ”¹frontend-evaluationç›®å½•** â†’ è§¦å‘è¯„ä¼°ç®¡ç†å®¢æˆ·ç«¯æ„å»ºï¼ˆç«¯å£3335ï¼‰
4. **ä¿®æ”¹backendç›®å½•** â†’ è§¦å‘æ‰€æœ‰å®¢æˆ·ç«¯æ„å»º

## ğŸ“¦ å‘å¸ƒåŒ…

æ¯ä¸ªæ„å»ºéƒ½ä¼šç”Ÿæˆï¼š
- `urbanization.tar` - ä¸»åº”ç”¨é•œåƒ
- `alpine.tar` - AlpineåŸºç¡€é•œåƒ
- `urbanization.zip` - å®Œæ•´çš„å®¢æˆ·ç«¯è¿è¡ŒåŒ…

å‘å¸ƒåŒ…åŒ…å«ï¼š
- Docker Composeé…ç½®æ–‡ä»¶
- PowerShellå¯åŠ¨è„šæœ¬
- å¤‡ä»½å’Œæ¢å¤è„šæœ¬
- ä½¿ç”¨è¯´æ˜æ–‡æ¡£

## ğŸ”„ å‘åå…¼å®¹

- åŸæœ‰çš„ `Dockerfile` å’Œå·¥ä½œæµä»ç„¶å¯ç”¨
- æ‰€æœ‰è„šæœ¬ä¸­çš„æ–‡ä»¶åå’Œå‚æ•°ä¿æŒä¸å˜
- ç”¨æˆ·å¯ä»¥æ— ç¼å‡çº§åˆ°æ–°çš„å¤šé¡¹ç›®æ¶æ„

## ğŸ“ æ³¨æ„äº‹é¡¹

1. **å¹¶å‘æ§åˆ¶**ï¼šæ¯ä¸ªå·¥ä½œæµéƒ½æœ‰ç‹¬ç«‹çš„å¹¶å‘ç»„ï¼Œé¿å…å†²çª
2. **è·¯å¾„è§¦å‘**ï¼šç¡®ä¿åªæœ‰ç›¸å…³æ–‡ä»¶å˜æ›´æ—¶æ‰è§¦å‘æ„å»º
3. **ç»Ÿä¸€è¾“å‡º**ï¼šæ‰€æœ‰æ„å»ºéƒ½ç”Ÿæˆç›¸åŒçš„æ–‡ä»¶åï¼Œä¾¿äºè„šæœ¬å¤„ç†
4. **ç‰ˆæœ¬æ ‡ç­¾**ï¼šä¸åŒé¡¹ç›®ä½¿ç”¨ä¸åŒçš„ç‰ˆæœ¬æ ‡ç­¾å‰ç¼€ï¼ˆrelease-data-ã€release-score-ã€release-evaluation-ï¼‰
5. **ç«¯å£éš”ç¦»**ï¼šä¸åŒé¡¹ç›®ä½¿ç”¨ä¸åŒç«¯å£ï¼Œé¿å…å†²çª
6. **æ•°æ®å·éš”ç¦»**ï¼šæ¯ä¸ªé¡¹ç›®ä½¿ç”¨ç‹¬ç«‹çš„æ•°æ®å·ï¼Œæ•°æ®äº’ä¸å¹²æ‰°
7. **æ–‡ä»¶é‡å‘½å**ï¼šGitHubå·¥ä½œæµä¼šè‡ªåŠ¨å°†å¯¹åº”çš„docker-composeæ–‡ä»¶é‡å‘½åä¸ºdocker-compose.ymlï¼Œç¡®ä¿startè„šæœ¬æ— éœ€ä¿®æ”¹ 